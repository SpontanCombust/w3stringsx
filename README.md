# w3stringsx

Script meant as an alternative CLI frontend for w3strings encoder, providing additional functionalities to make working with localized Witcher 3 content easier and faster.

w3stringsx is able to work with the regular form of the CSV file. It is however capable of reading non-standard data, which is explained later in this document.

## How-To
Put the script in the same folder as the w3strings encoder. Run commands on it using shell of your choice like cmd.exe.
Requires [python](https://www.python.org/downloads/) in version >= 3.11 to be installed.
Current CLI specification can be found [here](./doc/cli_specification.md).


## Features

### File type context awareness
If you give it a csv file it will encode. If you give it a w3strings file, it will decode it.
```shell
# Encodes the file
python w3stringsx.py "path\to\en.csv"

# Decodes the file
python w3stringsx.py "path\to\en.w3strings"
```

### Header optionality
The encoder requires these two lines to be present in the CSV file at the very beginning:
```csv
;meta[language=en]
; id      |key(hex)|key(str)| text
```
w3stringsx takes care of adding these for you, so you don't have to add them yourself.

Script does not modify the file you give it. It creates a temporary one where the final result is saved. Normally it gets deleted after it is done, but you can choose to keep it by adding `-k` or `--keep-csv` flag in the terminal.

### Language context awareness
w3stringsx will specify language metadata automatically based on file name. If it's `en.csv` then it will set `meta[language=en]`, if it's `es.csv` it will set `meta[language=es]`, if `ar.csv` then `meta[language=cleartext]` and so on. 

Files don't have to be named exactly that, only one of the components divided by the dot needs to be the language identifier, for example `w3ee.en.final.csv`.

If the traditional CSV header is still present, it will take the metadata from there. If no language metadata could be deduced in any way it defaults to English (`meta[language=en]`).

### ID space deduction
Script will go through all the records in the CSV file and see what ID space is used. For example
```csv
2115018009|        |panel_Mods|Mods
``` 
yields 5018. This ID will be passed onto the encoder.

If the file contains vanilla IDs it will disable the ID check. The entire process is accompanied by informative messages so you know if everything was read correctly.

### Abbreviated entries
Writing IDs by hand can be tiresome. This is why w3stringsx allows to completely get rid of that step.
At the top of file write a comment that specifies the ID space that should be used:
```csv
;idspace=5018
```
Then you will be able to add records that have only string key and text columns like so:
```csv
panel_Mods|Mods
panel_mod_settings|Mod settings
preset_value_mod_default|Default
```

Note that you can still add complete lines with IDs if you want to edit vanilla strings. You shouldn't however add complete lines with IDs in the space of your mod as they may overlap with those generated by the script.

### Encoding all possible languages
Even if your mod was not made with some languages in mind, their respective w3strings files still need to be created so that modded text appears properly, even if in a different laguage. This is usually done by first encoding one w3strings file in the language of your choosing, for example English as en.w3strings. Then that file is copied and renamed to es.w3strings, fr.w3strings and so on.

w3stringsx can to this automatically after encoding. The `-l` or `--language` option specifies the target encoding language. It can take `"all"` value, which means it will create w3strings file for every possible language. This is the default value.
```shell
# Creates all possible w3strings files
python w3stringsx.py "path\to\en.csv"

# Creates only en.w3strings
python w3stringsx.py "path\to\en.csv" -l "en"
```